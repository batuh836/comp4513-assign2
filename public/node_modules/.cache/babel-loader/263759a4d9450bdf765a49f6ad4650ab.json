{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Guild/Documents/GitHub/comp4513-assign2/public/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import FavouritesList from\"./FavouritesList.js\";import PlayOverview from\"./PlayOverview.js\";import PlayData from\"./PlayData.js\";import\"./css/PlayDetailApp.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PlayDetailApp=/*#__PURE__*/function(_React$Component){_inherits(PlayDetailApp,_React$Component);var _super=_createSuper(PlayDetailApp);function PlayDetailApp(props){var _this;_classCallCheck(this,PlayDetailApp);_this=_super.call(this,props);//initialize available tabs\nvar tabs=[\"Details\",\"Characters\",\"Text\"];//initialize state values\n_this.state={currentTab:tabs[0],tabs:props.play.filename?tabs:[tabs[0]],playData:[],currentAct:null,currentScene:null,currentCharacter:\"All Players\",searchText:\"\"};return _this;}_createClass(PlayDetailApp,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var foundPlayData,url,response,data,playText;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!this.props.play.filename){_context.next=26;break;}//find saved data with play id\nfoundPlayData=this.props.savedPlayData.find(function(p){return p.id===_this2.props.play.id;});//if not saved data is found, fetch\nif(foundPlayData){_context.next=23;break;}_context.prev=3;url=\"https://comp4513-assign2.herokuapp.com/api/play/\"+this.props.play.id;_context.next=7;return fetch(url);case 7:response=_context.sent;_context.next=10;return response.json();case 10:data=_context.sent;playText=data[0].playText;this.setState({playData:playText});//console.log(playText);\n//set current act and scene with first in arrays\nthis.setState({currentAct:playText.acts[0]});this.setState({currentScene:playText.acts[0].scenes[0]});//save play data\nthis.props.savePlayData(this.props.play,playText);_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](3);console.error(\"fetch error\");case 21:_context.next=26;break;case 23://if saved play data is found, set state values\nthis.setState({playData:foundPlayData.data});this.setState({currentAct:foundPlayData.data.acts[0]});this.setState({currentScene:foundPlayData.data.acts[0].scenes[0]});case 26:case\"end\":return _context.stop();}}},_callee,this,[[3,18]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;var setCurrentTab=function setCurrentTab(tab){_this3.setState({currentTab:tab});};var setPlayFilter=function setPlayFilter(name,value){if(name===\"act\"){//find act from play data and set first scene\nvar foundAct=_this3.state.playData.acts.find(function(a){return a.name===value;});_this3.setState({currentAct:foundAct});_this3.setState({currentScene:foundAct.scenes[0]});_this3.setState({currentCharacter:\"All Players\"});}else if(name===\"scene\"){//find scene from current act\nvar foundScene=_this3.state.currentAct.scenes.find(function(s){return s.name===value;});_this3.setState({currentScene:foundScene});_this3.setState({currentCharacter:\"All Players\"});}else if(name===\"character\"){//set current character\n_this3.setState({currentCharacter:value});}};var setSearchText=function setSearchText(text){_this3.setState({searchText:text});};return/*#__PURE__*/_jsxs(\"div\",{className:\"play-detail hide-favourites\",children:[/*#__PURE__*/_jsx(FavouritesList,{favourites:this.props.favourites,removeFromFavourites:this.props.removeFromFavourites}),/*#__PURE__*/_jsx(PlayOverview,{currentTab:this.state.currentTab,play:this.props.play,playData:this.state.playData,currentAct:this.state.currentAct,currentScene:this.state.currentScene,addToFavourites:this.props.addToFavourites,setPlayFilter:setPlayFilter,setSearchText:setSearchText}),/*#__PURE__*/_jsx(PlayData,{currentTab:this.state.currentTab,tabs:this.state.tabs,play:this.props.play,playData:this.state.playData,currentAct:this.state.currentAct,currentScene:this.state.currentScene,currentCharacter:this.state.currentCharacter,searchText:this.state.searchText,setCurrentTab:setCurrentTab})]});}}]);return PlayDetailApp;}(React.Component);;export default PlayDetailApp;","map":{"version":3,"sources":["/Users/Guild/Documents/GitHub/comp4513-assign2/public/src/components/PlayDetailApp.js"],"names":["React","FavouritesList","PlayOverview","PlayData","PlayDetailApp","props","tabs","state","currentTab","play","filename","playData","currentAct","currentScene","currentCharacter","searchText","foundPlayData","savedPlayData","find","p","id","url","fetch","response","json","data","playText","setState","acts","scenes","savePlayData","console","error","setCurrentTab","tab","setPlayFilter","name","value","foundAct","a","foundScene","s","setSearchText","text","favourites","removeFromFavourites","addToFavourites","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport FavouritesList from \"./FavouritesList.js\";\nimport PlayOverview from \"./PlayOverview.js\";\nimport PlayData from \"./PlayData.js\";\nimport \"./css/PlayDetailApp.css\";\n\nclass PlayDetailApp extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        //initialize available tabs\n        const tabs = [\"Details\", \"Characters\", \"Text\"];\n        \n        //initialize state values\n        this.state = {currentTab: tabs[0],\n                      tabs: props.play.filename ? tabs : [tabs[0]],\n                      playData: [],\n                      currentAct: null,\n                      currentScene: null,\n                      currentCharacter: \"All Players\",\n                      searchText: \"\"};\n    }\n                            \n    async componentDidMount() {\n        //only get data if filename is not null\n        if (this.props.play.filename) {\n            //find saved data with play id\n            const foundPlayData = this.props.savedPlayData.find((p) => p.id === this.props.play.id);\n            \n            //if not saved data is found, fetch\n            if (!foundPlayData) {\n                try {\n                    const url = \"https://comp4513-assign2.herokuapp.com/api/play/\" + this.props.play.id;\n                    const response = await fetch(url);\n                    const data = await response.json();\n                    const playText = data[0].playText;\n                    this.setState({playData: playText});\n                    //console.log(playText);\n                    \n                    //set current act and scene with first in arrays\n                    this.setState({currentAct: playText.acts[0]});\n                    this.setState({currentScene: playText.acts[0].scenes[0]});\n                    \n                    //save play data\n                    this.props.savePlayData(this.props.play, playText);\n                } \n                catch {\n                    console.error(\"fetch error\");\n                }\n            }\n            else {\n                //if saved play data is found, set state values\n                this.setState({playData: foundPlayData.data});\n                this.setState({currentAct: foundPlayData.data.acts[0]});\n                this.setState({currentScene: foundPlayData.data.acts[0].scenes[0]});\n            }\n        }\n    }\n    \n    render() {\n        const setCurrentTab = (tab) => {\n            this.setState({currentTab: tab});\n        }\n        \n        const setPlayFilter = (name, value) => {\n            if (name === \"act\") {\n                //find act from play data and set first scene\n                const foundAct = this.state.playData.acts.find((a) => a.name === value);\n                this.setState({currentAct: foundAct});\n                this.setState({currentScene: foundAct.scenes[0]});\n                this.setState({currentCharacter: \"All Players\"});\n            }\n            else if (name === \"scene\") {\n                //find scene from current act\n                const foundScene = this.state.currentAct.scenes.find((s) => s.name === value);\n                this.setState({currentScene: foundScene});\n                this.setState({currentCharacter: \"All Players\"});\n            }\n            else if (name === \"character\") {\n                //set current character\n                this.setState({currentCharacter: value});\n            }\n        }\n        \n        const setSearchText = (text) => {\n            this.setState({searchText: text});\n        }\n        \n        return (\n            <div className=\"play-detail hide-favourites\">\n                <FavouritesList favourites={this.props.favourites} \n                                removeFromFavourites={this.props.removeFromFavourites}/>\n                <PlayOverview currentTab={this.state.currentTab} \n                              play={this.props.play} \n                              playData={this.state.playData} \n                              currentAct={this.state.currentAct} \n                              currentScene={this.state.currentScene} \n                              addToFavourites={this.props.addToFavourites}\n                              setPlayFilter={setPlayFilter}\n                              setSearchText={setSearchText}/>\n                <PlayData currentTab={this.state.currentTab} \n                          tabs={this.state.tabs} \n                          play={this.props.play} \n                          playData={this.state.playData} \n                          currentAct={this.state.currentAct}\n                          currentScene={this.state.currentScene}\n                          currentCharacter={this.state.currentCharacter}\n                          searchText={this.state.searchText}\n                          setCurrentTab={setCurrentTab}/>\n            </div>\n        );\n    }\n};\n\nexport default PlayDetailApp"]},"metadata":{},"sourceType":"module"}